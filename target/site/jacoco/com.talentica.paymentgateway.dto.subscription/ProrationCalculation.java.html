<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ProrationCalculation.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">payment-gateway</a> &gt; <a href="index.source.html" class="el_package">com.talentica.paymentgateway.dto.subscription</a> &gt; <span class="el_source">ProrationCalculation.java</span></div><h1>ProrationCalculation.java</h1><pre class="source lang-java linenums">package com.talentica.paymentgateway.dto.subscription;

import com.fasterxml.jackson.annotation.JsonProperty;
import io.swagger.v3.oas.annotations.media.Schema;

import java.math.BigDecimal;
import java.time.ZonedDateTime;

/**
 * DTO for proration calculation results.
 * Contains detailed breakdown of proration amounts and reasoning.
 * 
 * @author Payment Gateway Team
 * @version 1.0.0
 */
@Schema(description = &quot;Proration calculation details for subscription changes&quot;)
public class ProrationCalculation {

    @Schema(description = &quot;Original plan amount&quot;, example = &quot;29.99&quot;)
    @JsonProperty(&quot;originalAmount&quot;)
    private BigDecimal originalAmount;

    @Schema(description = &quot;New plan amount&quot;, example = &quot;49.99&quot;)
    @JsonProperty(&quot;newAmount&quot;)
    private BigDecimal newAmount;

    @Schema(description = &quot;Current period start date&quot;, example = &quot;2024-01-01T00:00:00Z&quot;)
    @JsonProperty(&quot;periodStart&quot;)
    private ZonedDateTime periodStart;

    @Schema(description = &quot;Current period end date&quot;, example = &quot;2024-02-01T00:00:00Z&quot;)
    @JsonProperty(&quot;periodEnd&quot;)
    private ZonedDateTime periodEnd;

    @Schema(description = &quot;Change effective date&quot;, example = &quot;2024-01-15T00:00:00Z&quot;)
    @JsonProperty(&quot;changeDate&quot;)
    private ZonedDateTime changeDate;

    @Schema(description = &quot;Total days in current period&quot;, example = &quot;31&quot;)
    @JsonProperty(&quot;totalDaysInPeriod&quot;)
    private Integer totalDaysInPeriod;

    @Schema(description = &quot;Days remaining in period&quot;, example = &quot;17&quot;)
    @JsonProperty(&quot;daysRemaining&quot;)
    private Integer daysRemaining;

    @Schema(description = &quot;Days used in period&quot;, example = &quot;14&quot;)
    @JsonProperty(&quot;daysUsed&quot;)
    private Integer daysUsed;

    @Schema(description = &quot;Unused amount from original plan&quot;, example = &quot;13.54&quot;)
    @JsonProperty(&quot;unusedAmount&quot;)
    private BigDecimal unusedAmount;

    @Schema(description = &quot;Prorated amount for new plan&quot;, example = &quot;27.41&quot;)
    @JsonProperty(&quot;proratedAmount&quot;)
    private BigDecimal proratedAmount;

    @Schema(description = &quot;Net proration amount (credit if negative, charge if positive)&quot;, example = &quot;13.87&quot;)
    @JsonProperty(&quot;netAmount&quot;)
    private BigDecimal netAmount;

    @Schema(description = &quot;Whether this is a credit (negative) or charge (positive)&quot;, example = &quot;CHARGE&quot;)
    @JsonProperty(&quot;type&quot;)
    private String type; // CREDIT or CHARGE

    @Schema(description = &quot;Detailed calculation explanation&quot;)
    @JsonProperty(&quot;explanation&quot;)
    private String explanation;

    @Schema(description = &quot;Currency code&quot;, example = &quot;USD&quot;)
    @JsonProperty(&quot;currency&quot;)
    private String currency;

    @Schema(description = &quot;Whether proration applies&quot;, example = &quot;true&quot;)
    @JsonProperty(&quot;prorationApplies&quot;)
    private Boolean prorationApplies;

    @Schema(description = &quot;Reason why proration does/doesn't apply&quot;)
    @JsonProperty(&quot;prorationReason&quot;)
    private String prorationReason;

    // Default constructor
<span class="fc" id="L84">    public ProrationCalculation() {</span>
<span class="fc" id="L85">    }</span>

    // Constructor for no proration case
<span class="fc" id="L88">    public ProrationCalculation(String reason) {</span>
<span class="fc" id="L89">        this.prorationApplies = false;</span>
<span class="fc" id="L90">        this.prorationReason = reason;</span>
<span class="fc" id="L91">        this.netAmount = BigDecimal.ZERO;</span>
<span class="fc" id="L92">        this.type = &quot;NONE&quot;;</span>
<span class="fc" id="L93">    }</span>

    // Getters and Setters
    public BigDecimal getOriginalAmount() {
<span class="fc" id="L97">        return originalAmount;</span>
    }

    public void setOriginalAmount(BigDecimal originalAmount) {
<span class="fc" id="L101">        this.originalAmount = originalAmount;</span>
<span class="fc" id="L102">    }</span>

    public BigDecimal getNewAmount() {
<span class="fc" id="L105">        return newAmount;</span>
    }

    public void setNewAmount(BigDecimal newAmount) {
<span class="fc" id="L109">        this.newAmount = newAmount;</span>
<span class="fc" id="L110">    }</span>

    public ZonedDateTime getPeriodStart() {
<span class="fc" id="L113">        return periodStart;</span>
    }

    public void setPeriodStart(ZonedDateTime periodStart) {
<span class="fc" id="L117">        this.periodStart = periodStart;</span>
<span class="fc" id="L118">    }</span>

    public ZonedDateTime getPeriodEnd() {
<span class="fc" id="L121">        return periodEnd;</span>
    }

    public void setPeriodEnd(ZonedDateTime periodEnd) {
<span class="fc" id="L125">        this.periodEnd = periodEnd;</span>
<span class="fc" id="L126">    }</span>

    public ZonedDateTime getChangeDate() {
<span class="fc" id="L129">        return changeDate;</span>
    }

    public void setChangeDate(ZonedDateTime changeDate) {
<span class="fc" id="L133">        this.changeDate = changeDate;</span>
<span class="fc" id="L134">    }</span>

    public Integer getTotalDaysInPeriod() {
<span class="fc" id="L137">        return totalDaysInPeriod;</span>
    }

    public void setTotalDaysInPeriod(Integer totalDaysInPeriod) {
<span class="fc" id="L141">        this.totalDaysInPeriod = totalDaysInPeriod;</span>
<span class="fc" id="L142">    }</span>

    public Integer getDaysRemaining() {
<span class="fc" id="L145">        return daysRemaining;</span>
    }

    public void setDaysRemaining(Integer daysRemaining) {
<span class="fc" id="L149">        this.daysRemaining = daysRemaining;</span>
<span class="fc" id="L150">    }</span>

    public Integer getDaysUsed() {
<span class="fc" id="L153">        return daysUsed;</span>
    }

    public void setDaysUsed(Integer daysUsed) {
<span class="fc" id="L157">        this.daysUsed = daysUsed;</span>
<span class="fc" id="L158">    }</span>

    public BigDecimal getUnusedAmount() {
<span class="fc" id="L161">        return unusedAmount;</span>
    }

    public void setUnusedAmount(BigDecimal unusedAmount) {
<span class="fc" id="L165">        this.unusedAmount = unusedAmount;</span>
<span class="fc" id="L166">    }</span>

    public BigDecimal getProratedAmount() {
<span class="fc" id="L169">        return proratedAmount;</span>
    }

    public void setProratedAmount(BigDecimal proratedAmount) {
<span class="fc" id="L173">        this.proratedAmount = proratedAmount;</span>
<span class="fc" id="L174">    }</span>

    public BigDecimal getNetAmount() {
<span class="fc" id="L177">        return netAmount;</span>
    }

    public void setNetAmount(BigDecimal netAmount) {
<span class="fc" id="L181">        this.netAmount = netAmount;</span>
<span class="fc bfc" id="L182" title="All 2 branches covered.">        this.type = netAmount.compareTo(BigDecimal.ZERO) &gt;= 0 ? &quot;CHARGE&quot; : &quot;CREDIT&quot;;</span>
<span class="fc" id="L183">    }</span>

    public String getType() {
<span class="fc" id="L186">        return type;</span>
    }

    public void setType(String type) {
<span class="nc" id="L190">        this.type = type;</span>
<span class="nc" id="L191">    }</span>

    public String getExplanation() {
<span class="fc" id="L194">        return explanation;</span>
    }

    public void setExplanation(String explanation) {
<span class="fc" id="L198">        this.explanation = explanation;</span>
<span class="fc" id="L199">    }</span>

    public String getCurrency() {
<span class="fc" id="L202">        return currency;</span>
    }

    public void setCurrency(String currency) {
<span class="fc" id="L206">        this.currency = currency;</span>
<span class="fc" id="L207">    }</span>

    public Boolean getProrationApplies() {
<span class="fc" id="L210">        return prorationApplies;</span>
    }

    public void setProrationApplies(Boolean prorationApplies) {
<span class="fc" id="L214">        this.prorationApplies = prorationApplies;</span>
<span class="fc" id="L215">    }</span>

    public String getProrationReason() {
<span class="fc" id="L218">        return prorationReason;</span>
    }

    public void setProrationReason(String prorationReason) {
<span class="fc" id="L222">        this.prorationReason = prorationReason;</span>
<span class="fc" id="L223">    }</span>

    public boolean isCredit() {
<span class="fc" id="L226">        return &quot;CREDIT&quot;.equals(type);</span>
    }

    public boolean isCharge() {
<span class="fc" id="L230">        return &quot;CHARGE&quot;.equals(type);</span>
    }

    public boolean hasAmount() {
<span class="pc bpc" id="L234" title="1 of 4 branches missed.">        return netAmount != null &amp;&amp; netAmount.compareTo(BigDecimal.ZERO) != 0;</span>
    }

    public String getFormattedNetAmount() {
<span class="pc bpc" id="L238" title="1 of 2 branches missed.">        if (netAmount == null) return &quot;0.00&quot;;</span>
<span class="fc" id="L239">        return String.format(&quot;$%.2f&quot;, netAmount.abs());</span>
    }

    @Override
    public String toString() {
<span class="nc" id="L244">        return &quot;ProrationCalculation{&quot; +</span>
                &quot;originalAmount=&quot; + originalAmount +
                &quot;, newAmount=&quot; + newAmount +
                &quot;, netAmount=&quot; + netAmount +
                &quot;, type='&quot; + type + '\'' +
                &quot;, daysRemaining=&quot; + daysRemaining +
                &quot;, totalDaysInPeriod=&quot; + totalDaysInPeriod +
                &quot;, prorationApplies=&quot; + prorationApplies +
                '}';
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>